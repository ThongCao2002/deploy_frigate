import{_ as h,p as x,o as y}from"./index-1b1f5707.js";import{v as u}from"./video.es-306ef4f3.js";/*! @name videojs-playlist @version 5.1.0 @license Apache-2.0 */const v=t=>typeof t=="number"&&!isNaN(t)&&t>=0&&t<1/0;let I=t=>{const i=t.playlist.autoadvance_;i.timeout&&t.clearTimeout(i.timeout),i.trigger&&t.off("ended",i.trigger),i.timeout=null,i.trigger=null};const p=(t,i)=>{if(I(t),!v(i)){t.playlist.autoadvance_.delay=null;return}t.playlist.autoadvance_.delay=i,t.playlist.autoadvance_.trigger=function(){const s=()=>p(t,i);t.one("play",s),t.playlist.autoadvance_.timeout=t.setTimeout(()=>{I(t),t.off("play",s),t.playlist.next()},i*1e3)},t.one("ended",t.playlist.autoadvance_.trigger)},w=t=>{const i=t.remoteTextTracks();let s=i&&i.length||0;for(;s--;)t.removeRemoteTextTrack(i[s])},b=(t,i)=>{const s=!t.paused()||t.ended();return t.trigger("beforeplaylistitem",i.originalValue||i),i.playlistItemId_&&(t.playlist.currentPlaylistItemId_=i.playlistItemId_),t.poster(i.poster||""),t.src(i.sources),w(t),t.ready(()=>{if((i.textTracks||[]).forEach(t.addRemoteTextTrack.bind(t)),t.trigger("playlistitem",i.originalValue||i),s){const n=t.play();typeof n<"u"&&typeof n.then=="function"&&n.then(null,a=>{})}p(t,t.playlist.autoadvance_.delay)}),t};let A=1;const O=t=>{let i=t;return(!t||typeof t!="object")&&(i=Object(t),i.originalValue=t),i.playlistItemId_=A++,i},_=t=>t.map(O),S=(t,i)=>{for(let s=0;s<t.length;s++)if(t[s].playlistItemId_===i)return s;return-1},P=(t,i)=>{let s=t,n=i;return typeof t=="object"&&(s=t.src),typeof i=="object"&&(n=i.src),/^\/\//.test(s)&&(n=n.slice(n.indexOf("//"))),/^\/\//.test(n)&&(s=s.slice(s.indexOf("//"))),s===n},d=(t,i)=>{for(let s=0;s<t.length;s++){const n=t[s].sources;if(Array.isArray(n))for(let a=0;a<n.length;a++){const e=n[a];if(e&&P(e,i))return s}}return-1},k=t=>{let i=-1;const s=t.length-1;for(;++i<t.length;){const n=i+Math.floor(Math.random()*(s-i+1)),a=t[n];t[n]=t[i],t[i]=a}return t};function V(t,i,s=0){let n=null,a=!1;const e=t.playlist=(r,o=0)=>{if(a)throw new Error("do not call playlist() during a playlist change");if(Array.isArray(r)){const l=Array.isArray(n)?n.slice():null;n=_(r),a=!0,t.trigger({type:"duringplaylistchange",nextIndex:o,nextPlaylist:r,previousIndex:e.currentIndex_,previousPlaylist:l||[]}),a=!1,o!==-1&&e.currentItem(o),l&&t.setTimeout(()=>{t.trigger({type:"playlistchange",action:"change"})},0)}return n.map(l=>l.originalValue||l)};return t.on("loadstart",()=>{e.currentItem()===-1&&I(t)}),e.currentIndex_=-1,e.player_=t,e.autoadvance_={},e.repeat_=!1,e.currentPlaylistItemId_=null,e.currentItem=r=>{if(a)return e.currentIndex_;if(typeof r=="number"&&e.currentIndex_!==r&&r>=0&&r<n.length)return e.currentIndex_=r,b(e.player_,n[e.currentIndex_]),r>0&&t.poster(""),e.currentIndex_;const o=e.player_.currentSrc()||"";if(e.currentPlaylistItemId_){const l=S(n,e.currentPlaylistItemId_),c=n[l];if(c&&Array.isArray(c.sources)&&d([c],o)>-1)return e.currentIndex_=l,e.currentIndex_;e.currentPlaylistItemId_=null}return e.currentIndex_=e.indexOf(o),e.currentIndex_},e.add=(r,o)=>{if(a)throw new Error("cannot modify a playlist that is currently changing");(typeof o!="number"||o<0||o>n.length)&&(o=n.length),Array.isArray(r)||(r=[r]),n.splice(o,0,..._(r)),t.trigger({type:"playlistchange",action:"add"}),t.trigger({type:"playlistadd",count:r.length,index:o})},e.remove=(r,o=1)=>{if(a)throw new Error("cannot modify a playlist that is currently changing");typeof r!="number"||r<0||r>n.length||(n.splice(r,o),t.trigger({type:"playlistchange",action:"remove"}),t.trigger({type:"playlistremove",count:o,index:r}))},e.contains=r=>e.indexOf(r)!==-1,e.indexOf=r=>{if(typeof r=="string")return d(n,r);const o=Array.isArray(r)?r:r.sources;for(let l=0;l<o.length;l++){const c=o[l];if(typeof c=="string")return d(n,c);if(c.src)return d(n,c.src)}return-1},e.currentIndex=()=>e.currentItem(),e.lastIndex=()=>n.length-1,e.nextIndex=()=>{const r=e.currentItem();if(r===-1)return-1;const o=e.lastIndex();return e.repeat_&&r===o?0:Math.min(r+1,o)},e.previousIndex=()=>{const r=e.currentItem();return r===-1?-1:e.repeat_&&r===0?e.lastIndex():Math.max(r-1,0)},e.first=()=>{if(a)return;const r=e.currentItem(0);if(n.length)return n[r].originalValue||n[r];e.currentIndex_=-1},e.last=()=>{if(a)return;const r=e.currentItem(e.lastIndex());if(n.length)return n[r].originalValue||n[r];e.currentIndex_=-1},e.next=()=>{if(a)return;const r=e.nextIndex();if(r!==e.currentIndex_){const o=e.currentItem(r);return n[o].originalValue||n[o]}},e.previous=()=>{if(a)return;const r=e.previousIndex();if(r!==e.currentIndex_){const o=e.currentItem(r);return n[o].originalValue||n[o]}},e.autoadvance=r=>{p(e.player_,r)},e.repeat=r=>{if(r===void 0)return e.repeat_;if(typeof r!="boolean"){u.log.error("videojs-playlist: Invalid value for repeat",r);return}return e.repeat_=!!r,e.repeat_},e.sort=r=>{n.length&&(n.sort(r),!a&&t.trigger("playlistsorted"))},e.reverse=()=>{n.length&&(n.reverse(),!a&&t.trigger("playlistsorted"))},e.shuffle=({rest:r}={})=>{let o=0,l=n;r&&(o=e.currentIndex_+1,l=n.slice(o)),!(l.length<=1)&&(k(l),r&&n.splice(...[o,l.length].concat(l)),!a&&t.trigger("playlistsorted"))},Array.isArray(i)?e(i,s):n=[],e}var E="5.1.0";const T=u.registerPlugin||u.plugin,m=function(t,i){V(this,t,i)};T("playlist",m);m.VERSION=E;function F({children:t,options:i,seekOptions:s={forward:30,backward:10},onReady:n=()=>{},onDispose:a=()=>{}}){const e=h();return x(()=>{const r={controls:!0,controlBar:{skipButtons:s},playbackRates:[.5,1,2,4,8],fluid:!0};u.browser.IS_FIREFOX||r.playbackRates.push(16);const o=u(e.current,{...r,...i},()=>{n(o)});o.reloadSourceOnError(),t&&u.browser.IS_IOS&&u.browser.IOS_VERSION>9&&!o.el_.ownerDocument.querySelector(".bc-iframe")&&(o.tech_.el_.setAttribute("playsinline","playsinline"),o.tech_.supportsFullScreen=function(){return!1});const l=window.screen,c=()=>typeof window.orientation=="number"||l&&l.orientation&&l.orientation.angle?window.orientation:(u.log("angle unknown"),0),g=()=>{const f=c();(f===90||f===270||f===-90)&&o.paused()===!1&&o.requestFullscreen(),(f===0||f===180)&&o.isFullscreen()&&o.exitFullscreen()};return u.browser.IS_IOS?window.addEventListener("orientationchange",g):u.browser.IS_ANDROID&&l.orientation&&(l.orientation.onchange=g),()=>{u.browser.IS_IOS&&window.removeEventListener("orientationchange",g),o.dispose(),a()}},[]),y("div",{"data-vjs-player":!0,children:[y("video",{ref:e,className:"small-player video-js vjs-default-skin","data-setup":"{}",controls:!0,playsinline:!0}),t]})}export{F as V};
